# Development override - extends docker-compose.yml
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  postgres:
    container_name: saga-dev-postgres
    volumes:
      - postgres_dev_data:/var/lib/postgresql/data

  booking-api:
    image: booking-api:dev
    container_name: booking-api-dev
    build:
      dockerfile: ./src/Services/Booking.API/Dockerfile.dev
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ENABLE_WATCH=false
    ports:
      - "5011:5011" # Debug port
    depends_on:
      rabbitmq:
        condition: service_healthy
      postgres:
        condition: service_healthy
    volumes:
      - ./src/Services/Booking.API:/src/Services/Booking.API
      - ./src/Common:/src/Common

  flight-api:
    image: flight-api:dev
    container_name: flight-api-dev
    build:
      dockerfile: ./src/Services/Flight.API/Dockerfile.dev
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ENABLE_WATCH=false
    ports:
      - "5012:5012" # Debug port
    depends_on:
      rabbitmq:
        condition: service_healthy
      postgres:
        condition: service_healthy
      booking-api:
        condition: service_started
    volumes:
      - ./src/Services/Flight.API:/src/Services/Flight.API
      - ./src/Common:/src/Common

  hotel-api:
    image: hotel-api:dev
    container_name: hotel-api-dev
    build:
      dockerfile: ./src/Services/Hotel.API/Dockerfile.dev
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ENABLE_WATCH=false
    ports:
      - "5013:5013" # Debug port
    depends_on:
      rabbitmq:
        condition: service_healthy
      postgres:
        condition: service_healthy
      flight-api:
        condition: service_started
    volumes:
      - ./src/Services/Hotel.API:/src/Services/Hotel.API
      - ./src/Common:/src/Common

  car-api:
    image: car-api:dev
    container_name: car-api-dev
    build:
      dockerfile: ./src/Services/Car.API/Dockerfile.dev
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ENABLE_WATCH=false
    ports:
      - "5014:5014" # Debug port
    depends_on:
      rabbitmq:
        condition: service_healthy
      postgres:
        condition: service_healthy
      hotel-api:
        condition: service_started
    volumes:
      - ./src/Services/Car.API:/src/Services/Car.API
      - ./src/Common:/src/Common

volumes:
  postgres_dev_data:
